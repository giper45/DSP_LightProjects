{"description":"Your goal is to access at a private website in an internal network, bypassing the firewall rules","goal":"<p>Find the secret by using the Kali machine and by sending a curl request to web server with right credentials. You sniffed some traffic of router, you've saved in&nbsp;<strong>/history/log.pcap</strong>, try to understand if it gives some informations.&nbsp;</p>\n<p>Login access: <em>docker exec -it bypassthefirewall_kali_1 bash &nbsp;</em></p>\n<p>&nbsp;</p>\n<p><strong><em>Answer:&nbsp;</em></strong></p>\n<ul>\n<li>What is the error in web application ? In firewall configuration?&nbsp;</li>\n</ul>\n<p>&nbsp;</p>","solution":"<p>The web address is 192.168.1.3. If you try to ping it you won't have responses:&nbsp;</p>\n<p>&nbsp;<span style=\"color: #f4f4f4; font-family: Monaco; font-size: 10px; background-color: rgba(0, 0, 0, 0.85098);\">root@1ba718a0fcd1:/# ping 192.168.1.3</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">PING 192.168.1.3 (192.168.1.3) 56(84) bytes of data.&nbsp;</span></p>\n<p>Try to use nmap:</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@1ba718a0fcd1:/# nmap 192.168.1.3 -p 80 -Pn &nbsp;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">Starting Nmap 7.40 ( https://nmap.org ) at 2017-05-18 14:02 UTC</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">Nmap scan report for 192.168.1.3</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">Host is up.</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">PORT &nbsp; STATE&nbsp; &nbsp; SERVICE</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">80/tcp filtered http</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">Nmap done: 1 IP address (1 host up) scanned in 15.22 seconds</span></p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@1ba718a0fcd1:/#&nbsp;</span></p>\n<p>It says that the port 80 is filtered: the firewall is blocking it.&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;Look at the pcap file with Wireshark. Analize the tcp stream by using the following filter:</p>\n<p style=\"text-align: center;\"><em>tcp.stream eq #number_stream</em></p>\n<p>Observe the streams by setting #number_stream to 0,1, 2, ... and by right clicking on a packet and selecting Follow TCP Stream:&nbsp;</p>\n<ul>\n<li>Stream 0: client send&nbsp;name=administrator&amp;pwd=jack , server responds No correct Password&nbsp;</li>\n<li>Stream 2 : client send name=administrato&amp;pwd=administrator, server responds No correct Name.&nbsp;</li>\n</ul>\n<p>This is a banner grabbing: there is a different response if the user wrongs the name or the password. By using these information we know username and password. Another problem was the router filtering... if we look at the streams we can observe that the communication is between the web IP address (192.168.1.3) and this IP:&nbsp;</p>\n<p style=\"text-align: center;\"><strong>192.168.2.50 &nbsp;</strong></p>\n<p style=\"text-align: center;\">Another useful information is that the request&nbsp;goes to&nbsp;<strong>private.php page</strong>, so you'll have to send the request to this page</p>\n<p style=\"text-align: left;\">It seems that there is some firewall rule that allows this ip to enter in the internal network.&nbsp;</p>\n<p style=\"text-align: left;\">Try to change your IP and to send the ping:&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# ifconfig eth0 down</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# ifconfig eth0 192.168.2.50 netmask 255.255.255.0 up</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# route add default gw router</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# ping 192.168.1.3</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">PING 192.168.1.3 (192.168.1.3) 56(84) bytes of data.</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">64 bytes from 192.168.1.3: icmp_seq=1 ttl=63 time=0.288 ms</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">64 bytes from 192.168.1.3: icmp_seq=3 ttl=63 time=0.162 ms</span></p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">64 bytes from 192.168.1.3: icmp_seq=5 ttl=63 time=0.156 ms</span></p>\n<p style=\"text-align: left;\">As you can see the ping now works! Let's send the curl request:&nbsp;</p>\n<p style=\"text-align: left;\">&nbsp;</p>\n<p style=\"text-align: left;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# curl -X POST -d \"name=administrator&amp;pwd=administrator\" 192.168.1.3</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;html&gt;&lt;head&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;title&gt;404 Not Found&lt;/title&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/head&gt;&lt;body&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;h1&gt;Not Found&lt;/h1&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;p&gt;The requested URL / was not found on this server.&lt;/p&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;hr&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;address&gt;Apache/2.4.7 (Ubuntu) Server at 192.168.1.3 Port 80&lt;/address&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/body&gt;&lt;/html&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/# curl -X POST -d \"name=administrator&amp;pwd=administrator\" 192.168.1.3/private.php</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;!DOCTYPE html&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;html lang=\"en\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;head&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;title&gt;Private&lt;/title&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;meta charset=\"utf-8\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js\"&gt;&lt;/script&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js\"&gt;&lt;/script&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/head&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;body&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;div class=\"jumbotron text-center\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;h1&gt;Private area&lt;/h1&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;h3&gt;Your secret card is&nbsp; 4023402340234023&lt;/h3&gt;&lt;div class=\"container\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;div class=\"row\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;div class=\"col-sm-4\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;div class=\"col-sm-4\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;div class=\"col-sm-4\"&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &nbsp; &lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&nbsp; &lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/div&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/body&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">&lt;/html&gt;</span></p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098); min-height: 14px;\">&nbsp;</p>\n<p>&nbsp;</p>\n<p style=\"margin: 0px; font-size: 10px; line-height: normal; font-family: Monaco; color: #f4f4f4; background-color: rgba(0, 0, 0, 0.85098);\"><span style=\"font-variant-ligatures: no-common-ligatures;\">root@6ac56837ddb9:/#&nbsp;</span></p>\n<p><span style=\"font-variant-ligatures: no-common-ligatures;\">The secret to find&nbsp;is&nbsp;</span><span style=\"color: #f4f4f4; font-family: Monaco; font-size: 10px; background-color: rgba(0, 0, 0, 0.85098);\">4023402340234023</span></p>\n<p style=\"text-align: left;\">&nbsp;</p>","author":"giper"}
